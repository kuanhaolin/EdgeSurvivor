# Story 2.3: ç¤¾ç¾¤é€£çµ

## Status

Draft

## Story

**As a** ä½¿ç”¨è€…,
**I want** é€£çµæˆ‘çš„ç¤¾ç¾¤å¸³è™Ÿï¼ˆInstagram, Facebook, Line, Twitter ç­‰ï¼‰ä¸¦è¨­å®šæ˜¯å¦å…¬é–‹,
**so that** å…¶ä»–ç”¨æˆ¶å¯ä»¥é€éç¤¾ç¾¤å¹³å°èˆ‡æˆ‘è¯ç¹«ï¼Œå»ºç«‹æ›´æ·±å…¥çš„é€£çµã€‚

## Acceptance Criteria

### ç¤¾ç¾¤é€£çµè¡¨å–®é¡¯ç¤º

1. ä½¿ç”¨è€…å¯ä»¥åœ¨å€‹äººè³‡æ–™ç·¨è¼¯é é¢å­˜å–ã€Œç¤¾ç¾¤é€£çµã€å€å¡Š
2. é é¢æ‡‰é¡¯ç¤ºä»¥ä¸‹ç¤¾ç¾¤å¹³å°æ¬„ä½ï¼š
   - Instagramï¼ˆURL è¼¸å…¥æ¡†ï¼‰
   - Facebookï¼ˆURL è¼¸å…¥æ¡†ï¼‰
   - Line IDï¼ˆæ–‡å­—è¼¸å…¥æ¡†ï¼‰
   - Twitterï¼ˆURL è¼¸å…¥æ¡†ï¼‰
3. æ‰€æœ‰ç¤¾ç¾¤é€£çµæ¬„ä½ç‚ºé¸å¡«
4. æ¯å€‹æ¬„ä½æ‡‰æœ‰æ¸…æ¥šçš„æ¨™ç±¤å’Œç¯„ä¾‹æ–‡å­—ï¼ˆplaceholderï¼‰

### è¡¨å–®é©—è­‰

5. Instagram URL é©—è­‰ï¼š
   - è‹¥å¡«å¯«ï¼Œå¿…é ˆç¬¦åˆ Instagram URL æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`https://instagram.com/username` æˆ– `instagram.com/username`ï¼‰
   - é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼šã€Œè«‹è¼¸å…¥æœ‰æ•ˆçš„ Instagram ç¶²å€ã€
6. Facebook URL é©—è­‰ï¼š
   - è‹¥å¡«å¯«ï¼Œå¿…é ˆç¬¦åˆ Facebook URL æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`https://facebook.com/username`ï¼‰
   - é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼šã€Œè«‹è¼¸å…¥æœ‰æ•ˆçš„ Facebook ç¶²å€ã€
7. Line ID é©—è­‰ï¼š
   - è‹¥å¡«å¯«ï¼Œæ‡‰ç‚ºæœ‰æ•ˆçš„ Line ID æ ¼å¼ï¼ˆå­—æ¯ã€æ•¸å­—ã€åº•ç·šã€é»è™Ÿï¼Œé•·åº¦ 4-20 å­—å…ƒï¼‰
   - é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼šã€Œè«‹è¼¸å…¥æœ‰æ•ˆçš„ Line IDã€
8. Twitter URL é©—è­‰ï¼š
   - è‹¥å¡«å¯«ï¼Œå¿…é ˆç¬¦åˆ Twitter URL æ ¼å¼ï¼ˆä¾‹å¦‚ï¼š`https://twitter.com/username`ï¼‰
   - é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼šã€Œè«‹è¼¸å…¥æœ‰æ•ˆçš„ Twitter ç¶²å€ã€

### éš±ç§è¨­å®šåŠŸèƒ½

9. æä¾›ã€Œç¤¾ç¾¤é€£çµéš±ç§è¨­å®šã€é¸é …ï¼ŒåŒ…å«ï¼š
   - **å…¬é–‹**ï¼šæ‰€æœ‰ç”¨æˆ¶éƒ½å¯ä»¥çœ‹åˆ°æˆ‘çš„ç¤¾ç¾¤é€£çµ
   - **åƒ…å¥½å‹**ï¼šåªæœ‰å·²åª’åˆæˆåŠŸçš„å¥½å‹å¯ä»¥çœ‹åˆ°
10. éš±ç§è¨­å®šæ‡‰ä½¿ç”¨å–®é¸æŒ‰éˆ•ï¼ˆRadioï¼‰æˆ–ä¸‹æ‹‰é¸å–®
11. é è¨­å€¼ç‚ºã€Œå…¬é–‹ã€
12. è®Šæ›´éš±ç§è¨­å®šæ™‚æ‡‰å³æ™‚ç”Ÿæ•ˆ
13. éš±ç§è¨­å®šæ‡‰é¡¯ç¤ºæ¸…æ¥šçš„èªªæ˜æ–‡å­—

### å„²å­˜èˆ‡æ›´æ–°

14. é»æ“Šã€Œå„²å­˜ã€æŒ‰éˆ•è§¸ç™¼æ›´æ–°
15. å„²å­˜æˆåŠŸå¾Œï¼š
    - é¡¯ç¤ºæˆåŠŸè¨Šæ¯ã€Œç¤¾ç¾¤é€£çµå·²æ›´æ–°ï¼ã€
    - è‡ªå‹•æ›´æ–°é é¢ä¸Šçš„ç¤¾ç¾¤é€£çµé¡¯ç¤º
16. å„²å­˜å¤±æ•—æ™‚ï¼š
    - é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
    - ä¿ç•™åŸæœ‰è³‡æ–™
    - å…è¨±é‡æ–°å„²å­˜

### ç¤¾ç¾¤é€£çµé¡¯ç¤º

17. å·²å„²å­˜çš„ç¤¾ç¾¤é€£çµæ‡‰åœ¨ä»¥ä¸‹ä½ç½®é¡¯ç¤ºï¼š
    - å€‹äººè³‡æ–™é é¢ï¼ˆè‡ªå·±æŸ¥çœ‹æ™‚é¡¯ç¤ºæ‰€æœ‰é€£çµï¼‰
    - å…¶ä»–ç”¨æˆ¶çš„å€‹äººè³‡æ–™é é¢ï¼ˆä¾éš±ç§è¨­å®šé¡¯ç¤ºï¼‰
18. ç¤¾ç¾¤é€£çµæ‡‰ä»¥åœ–ç¤º + é€£çµæ–¹å¼å‘ˆç¾
19. é»æ“Šç¤¾ç¾¤é€£çµæ‡‰åœ¨æ–°åˆ†é é–‹å•Ÿ
20. æœªå¡«å¯«çš„ç¤¾ç¾¤é€£çµä¸æ‡‰é¡¯ç¤º

### éš±ç§ä¿è­·

21. æ ¹æ“šéš±ç§è¨­å®šï¼Œæ§åˆ¶ç¤¾ç¾¤é€£çµçš„å¯è¦‹æ€§ï¼š
    - **å…¬é–‹**ï¼šæ‰€æœ‰ç”¨æˆ¶å¯è¦‹
    - **åƒ…å¥½å‹**ï¼šåªæœ‰å·²åª’åˆæˆåŠŸçš„å¥½å‹å¯è¦‹ï¼ˆ`Match.status` ç‚º `accepted` æˆ– `confirmed`ï¼‰
22. éå¥½å‹æŸ¥çœ‹å€‹äººè³‡æ–™æ™‚ï¼Œç¤¾ç¾¤é€£çµå€å¡Šæ‡‰é¡¯ç¤ºã€Œæ­¤ç”¨æˆ¶çš„ç¤¾ç¾¤é€£çµåƒ…å°å¥½å‹å…¬é–‹ã€
23. æœ¬äººæŸ¥çœ‹è‡ªå·±çš„è³‡æ–™æ™‚ï¼Œæ‡‰å§‹çµ‚é¡¯ç¤ºæ‰€æœ‰ç¤¾ç¾¤é€£çµ

### ä½¿ç”¨è€…é«”é©—

24. è¡¨å–®æ¬„ä½æ‡‰æ”¯æ´è‡ªå‹•å¡«å……ï¼ˆAutocompleteï¼‰
25. ç¤¾ç¾¤é€£çµåœ–ç¤ºæ‡‰ä½¿ç”¨æ¸…æ™°å¯è¾¨è­˜çš„ Icon
26. éŸ¿æ‡‰å¼è¨­è¨ˆï¼šé©é…æ‰‹æ©Ÿã€å¹³æ¿ã€æ¡Œé¢
27. æä¾›ã€Œæ¸…é™¤ã€æŒ‰éˆ•å¿«é€Ÿæ¸…ç©ºæ¬„ä½

### å®‰å…¨æ€§

28. æ›´æ–°éœ€è¦ JWT èªè­‰
29. åªèƒ½æ›´æ–°è‡ªå·±çš„ç¤¾ç¾¤é€£çµ
30. API å›æ‡‰æ™‚é–“éœ€ä½æ–¼ 2000ms

## Tasks / Subtasks

> **ğŸ”§ Brownfield å°ˆæ¡ˆèªªæ˜**ï¼šå¾Œç«¯ User Model å·²åŒ…å«ç¤¾ç¾¤é€£çµæ¬„ä½ï¼ˆ`instagram_url`, `facebook_url`, `line_id`, `twitter_url`, `social_privacy`ï¼‰ï¼Œä¸” `PUT /api/users/profile` ç«¯é»å·²æ”¯æ´æ›´æ–°ç¤¾ç¾¤é€£çµã€‚æœ¬ Story è‘—é‡æ–¼**å»ºç«‹å‰ç«¯ç¤¾ç¾¤é€£çµç·¨è¼¯çµ„ä»¶**ã€**æ•´åˆç¾æœ‰ API**ï¼Œä»¥åŠ**å¯¦ä½œéš±ç§è¨­å®šèˆ‡é¡¯ç¤ºé‚è¼¯**ã€‚

### Phase 1: å¾Œç«¯é©—è­‰èˆ‡ç¢ºèª

- [ ] **Task 1: é©—è­‰ User Model ç¤¾ç¾¤é€£çµæ¬„ä½** (AC: 2, 9, 21)
  - [ ] âœ… ç¢ºèª `backend/models/user.py` åŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š
    - `instagram_url` (String(255))
    - `facebook_url` (String(255))
    - `line_id` (String(100))
    - `twitter_url` (String(255))
    - `social_privacy` (String(20), default='public')
  - [ ] âœ… ç¢ºèª `to_dict()` æ–¹æ³•åŒ…å« `social_links` å’Œéš±ç§é‚è¼¯
  - [ ] ğŸ“ è¨˜éŒ„ä»»ä½•èˆ‡è¦æ ¼ä¸ç¬¦çš„åœ°æ–¹

- [ ] **Task 2: é©—è­‰ Users API ç«¯é»** (AC: 14, 28, 29, 30)
  - [ ] âœ… ç¢ºèª `backend/blueprints/users.py` çš„ `update_profile()` ç«¯é»
  - [ ] âœ… é©—è­‰ç«¯é»è·¯å¾‘ç‚º `PUT /api/users/profile`
  - [ ] âœ… æª¢æŸ¥éœ€è¦ JWT èªè­‰ (`@jwt_required()`)
  - [ ] âœ… ç¢ºèªæ”¯æ´æ›´æ–° `social_links` æ¬„ä½ï¼š
    ```python
    if 'social_links' in data:
        social = data['social_links']
        if 'instagram' in social:
            user.instagram_url = social['instagram']
        if 'facebook' in social:
            user.facebook_url = social['facebook']
        if 'line' in social:
            user.line_id = social['line']
        if 'twitter' in social:
            user.twitter_url = social['twitter']
    ```
  - [ ] âœ… ç¢ºèª `update_privacy()` ç«¯é»æ”¯æ´ `social_privacy` æ›´æ–°
  - [ ] ğŸ§ª æ¸¬è©¦ API å›æ‡‰æ™‚é–“ < 2000ms
  - [ ] ğŸ“ è¨˜éŒ„ä»»ä½•èˆ‡è¦æ ¼ä¸ç¬¦çš„åœ°æ–¹

### Phase 2: å‰ç«¯ç¤¾ç¾¤é€£çµç·¨è¼¯çµ„ä»¶å»ºç«‹

- [ ] **Task 3: å»ºç«‹ SocialLinksEditor çµ„ä»¶** (AC: 1, 2, 3, 4)
  - [ ] â• åœ¨ `frontend/src/components/` å»ºç«‹ `SocialLinksEditor.vue`
  - [ ] â• ä½¿ç”¨ Element Plus `<el-form>` çµ„ä»¶
  - [ ] â• è¨­è¨ˆçµ„ä»¶çµæ§‹ï¼š
    - ç¤¾ç¾¤é€£çµè¡¨å–®å€å¡Š
    - éš±ç§è¨­å®šå€å¡Š
    - å„²å­˜æŒ‰éˆ•
  - [ ] â• å¯¦ä½œè¡¨å–®æ¬„ä½ï¼š
    ```vue
    <el-form-item label="Instagram" prop="instagram">
      <el-input 
        v-model="socialLinks.instagram" 
        placeholder="https://instagram.com/username"
        clearable
      >
        <template #prefix>
          <el-icon><BrandInstagram /></el-icon>
        </template>
      </el-input>
    </el-form-item>
    
    <el-form-item label="Facebook" prop="facebook">
      <el-input 
        v-model="socialLinks.facebook" 
        placeholder="https://facebook.com/username"
        clearable
      >
        <template #prefix>
          <el-icon><BrandFacebook /></el-icon>
        </template>
      </el-input>
    </el-form-item>
    
    <el-form-item label="Line ID" prop="line">
      <el-input 
        v-model="socialLinks.line" 
        placeholder="yourlineid"
        clearable
      >
        <template #prefix>
          <el-icon><BrandLine /></el-icon>
        </template>
      </el-input>
    </el-form-item>
    
    <el-form-item label="Twitter" prop="twitter">
      <el-input 
        v-model="socialLinks.twitter" 
        placeholder="https://twitter.com/username"
        clearable
      >
        <template #prefix>
          <el-icon><BrandTwitter /></el-icon>
        </template>
      </el-input>
    </el-form-item>
    ```

- [ ] **Task 4: å¯¦ä½œè¡¨å–®é©—è­‰** (AC: 5, 6, 7, 8)
  - [ ] â• åœ¨ `frontend/src/utils/validators.js` å»ºç«‹é©—è­‰å‡½æ•¸ï¼š
    ```javascript
    // Instagram URL é©—è­‰
    export const validateInstagramUrl = (rule, value, callback) => {
      if (!value) {
        callback()
        return
      }
      const instagramPattern = /^(https?:\/\/)?(www\.)?instagram\.com\/[\w.]+\/?$/
      if (instagramPattern.test(value)) {
        callback()
      } else {
        callback(new Error('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Instagram ç¶²å€'))
      }
    }
    
    // Facebook URL é©—è­‰
    export const validateFacebookUrl = (rule, value, callback) => {
      if (!value) {
        callback()
        return
      }
      const facebookPattern = /^(https?:\/\/)?(www\.)?facebook\.com\/[\w.]+\/?$/
      if (facebookPattern.test(value)) {
        callback()
      } else {
        callback(new Error('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Facebook ç¶²å€'))
      }
    }
    
    // Line ID é©—è­‰
    export const validateLineId = (rule, value, callback) => {
      if (!value) {
        callback()
        return
      }
      const linePattern = /^[a-zA-Z0-9._-]{4,20}$/
      if (linePattern.test(value)) {
        callback()
      } else {
        callback(new Error('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Line IDï¼ˆ4-20 å­—å…ƒï¼Œåƒ…é™å­—æ¯ã€æ•¸å­—ã€é»è™Ÿã€åº•ç·šã€æ¸›è™Ÿï¼‰'))
      }
    }
    
    // Twitter URL é©—è­‰
    export const validateTwitterUrl = (rule, value, callback) => {
      if (!value) {
        callback()
        return
      }
      const twitterPattern = /^(https?:\/\/)?(www\.)?(twitter\.com|x\.com)\/[\w]+\/?$/
      if (twitterPattern.test(value)) {
        callback()
      } else {
        callback(new Error('è«‹è¼¸å…¥æœ‰æ•ˆçš„ Twitter ç¶²å€'))
      }
    }
    ```
  - [ ] â• åœ¨ `SocialLinksEditor.vue` ä¸­æ‡‰ç”¨é©—è­‰è¦å‰‡ï¼š
    ```javascript
    const rules = {
      instagram: [{ validator: validateInstagramUrl, trigger: 'blur' }],
      facebook: [{ validator: validateFacebookUrl, trigger: 'blur' }],
      line: [{ validator: validateLineId, trigger: 'blur' }],
      twitter: [{ validator: validateTwitterUrl, trigger: 'blur' }]
    }
    ```

- [ ] **Task 5: å¯¦ä½œéš±ç§è¨­å®šåŠŸèƒ½** (AC: 9, 10, 11, 12, 13)
  - [ ] â• æ·»åŠ éš±ç§è¨­å®š UIï¼š
    ```vue
    <el-form-item label="éš±ç§è¨­å®š">
      <el-radio-group v-model="socialPrivacy">
        <el-radio label="public">
          å…¬é–‹
          <span class="privacy-hint">æ‰€æœ‰ç”¨æˆ¶éƒ½å¯ä»¥çœ‹åˆ°æˆ‘çš„ç¤¾ç¾¤é€£çµ</span>
        </el-radio>
        <el-radio label="friends_only">
          åƒ…å¥½å‹
          <span class="privacy-hint">åªæœ‰å·²åª’åˆæˆåŠŸçš„å¥½å‹å¯ä»¥çœ‹åˆ°</span>
        </el-radio>
      </el-radio-group>
    </el-form-item>
    ```
  - [ ] â• å¯¦ä½œéš±ç§è¨­å®šç‹€æ…‹ç®¡ç†ï¼š
    ```javascript
    const socialPrivacy = ref('public')
    ```

### Phase 3: API æ•´åˆ

- [ ] **Task 6: æ“´å±• Users API æœå‹™** (AC: 14, 15, 16)
  - [ ] â• åœ¨ `frontend/src/api/users.js` ç¢ºèª `updateProfile()` å‡½æ•¸
  - [ ] â• ç¢ºèªå‡½æ•¸æ”¯æ´æ›´æ–° `social_links` å’Œ `social_privacy`ï¼š
    ```javascript
    export const updateProfile = (profileData) => {
      return axios.put('/users/profile', profileData)
    }
    
    export const updatePrivacy = (privacyData) => {
      return axios.put('/users/privacy', privacyData)
    }
    ```

- [ ] **Task 7: å¯¦ä½œå„²å­˜é‚è¼¯** (AC: 14, 15, 16, 28, 29, 30)
  - [ ] â• å»ºç«‹ `handleSave()` å‡½æ•¸
  - [ ] â• é©—è­‰è¡¨å–®
  - [ ] â• èª¿ç”¨ API æ›´æ–°ç¤¾ç¾¤é€£çµå’Œéš±ç§è¨­å®šï¼š
    ```javascript
    const handleSave = async () => {
      try {
        // é©—è­‰è¡¨å–®
        await formRef.value.validate()
        
        loading.value = true
        
        // æ›´æ–°ç¤¾ç¾¤é€£çµ
        await updateProfile({
          social_links: {
            instagram: socialLinks.value.instagram,
            facebook: socialLinks.value.facebook,
            line: socialLinks.value.line,
            twitter: socialLinks.value.twitter
          }
        })
        
        // æ›´æ–°éš±ç§è¨­å®š
        await updatePrivacy({
          social_privacy: socialPrivacy.value
        })
        
        ElMessage.success('ç¤¾ç¾¤é€£çµå·²æ›´æ–°ï¼')
        emit('update-success')
        
      } catch (error) {
        if (error.message !== 'Validation failed') {
          console.error('æ›´æ–°ç¤¾ç¾¤é€£çµå¤±æ•—:', error)
          ElMessage.error('æ›´æ–°å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦')
        }
      } finally {
        loading.value = false
      }
    }
    ```

### Phase 4: ç¤¾ç¾¤é€£çµé¡¯ç¤ºçµ„ä»¶

- [ ] **Task 8: å»ºç«‹ SocialLinksDisplay çµ„ä»¶** (AC: 17, 18, 19, 20, 21, 22, 23)
  - [ ] â• åœ¨ `frontend/src/components/` å»ºç«‹ `SocialLinksDisplay.vue`
  - [ ] â• è¨­è¨ˆçµ„ä»¶çµæ§‹ï¼š
    ```vue
    <template>
      <div class="social-links-display">
        <h3>ç¤¾ç¾¤é€£çµ</h3>
        
        <!-- é¡¯ç¤ºç¤¾ç¾¤é€£çµ -->
        <div v-if="canViewSocialLinks" class="social-links-list">
          <a 
            v-if="socialLinks.instagram" 
            :href="socialLinks.instagram" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-link"
          >
            <el-icon><BrandInstagram /></el-icon>
            <span>Instagram</span>
          </a>
          
          <a 
            v-if="socialLinks.facebook" 
            :href="socialLinks.facebook" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-link"
          >
            <el-icon><BrandFacebook /></el-icon>
            <span>Facebook</span>
          </a>
          
          <a 
            v-if="socialLinks.line" 
            :href="`https://line.me/ti/p/${socialLinks.line}`" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-link"
          >
            <el-icon><BrandLine /></el-icon>
            <span>Line</span>
          </a>
          
          <a 
            v-if="socialLinks.twitter" 
            :href="socialLinks.twitter" 
            target="_blank" 
            rel="noopener noreferrer"
            class="social-link"
          >
            <el-icon><BrandTwitter /></el-icon>
            <span>Twitter</span>
          </a>
          
          <p v-if="!hasSocialLinks" class="no-links-message">
            æ­¤ç”¨æˆ¶å°šæœªè¨­å®šç¤¾ç¾¤é€£çµ
          </p>
        </div>
        
        <!-- éš±ç§é™åˆ¶æç¤º -->
        <div v-else class="privacy-notice">
          <el-icon><Lock /></el-icon>
          <p>æ­¤ç”¨æˆ¶çš„ç¤¾ç¾¤é€£çµåƒ…å°å¥½å‹å…¬é–‹</p>
        </div>
      </div>
    </template>
    
    <script setup>
    import { computed } from 'vue'
    import { Lock } from '@element-plus/icons-vue'
    
    const props = defineProps({
      socialLinks: {
        type: Object,
        required: true
      },
      socialPrivacy: {
        type: String,
        default: 'public'
      },
      isSelf: {
        type: Boolean,
        default: false
      },
      isFriend: {
        type: Boolean,
        default: false
      }
    })
    
    const canViewSocialLinks = computed(() => {
      // æœ¬äººå§‹çµ‚å¯è¦‹
      if (props.isSelf) return true
      
      // å…¬é–‹è¨­å®šæ‰€æœ‰äººå¯è¦‹
      if (props.socialPrivacy === 'public') return true
      
      // åƒ…å¥½å‹è¨­å®šï¼Œåªæœ‰å¥½å‹å¯è¦‹
      if (props.socialPrivacy === 'friends_only' && props.isFriend) return true
      
      return false
    })
    
    const hasSocialLinks = computed(() => {
      return !!(
        props.socialLinks.instagram ||
        props.socialLinks.facebook ||
        props.socialLinks.line ||
        props.socialLinks.twitter
      )
    })
    </script>
    ```

### Phase 5: æ•´åˆåˆ°å€‹äººè³‡æ–™é é¢

- [ ] **Task 9: æ•´åˆ SocialLinksEditor åˆ°ç·¨è¼¯é é¢** (AC: 1)
  - [ ] â• åœ¨ `frontend/src/views/ProfileEdit.vue` å¼•å…¥ `SocialLinksEditor` çµ„ä»¶
  - [ ] â• æ·»åŠ ç¤¾ç¾¤é€£çµç·¨è¼¯å€å¡Š
  - [ ] â• å¾ Auth Store æˆ– API è¼‰å…¥ç•¶å‰ç¤¾ç¾¤é€£çµè³‡æ–™
  - [ ] â• å„²å­˜æˆåŠŸå¾Œæ›´æ–° Auth Store

- [ ] **Task 10: æ•´åˆ SocialLinksDisplay åˆ°å€‹äººè³‡æ–™é é¢** (AC: 17, 21, 22, 23)
  - [ ] â• åœ¨ `frontend/src/views/Profile.vue` å¼•å…¥ `SocialLinksDisplay` çµ„ä»¶
  - [ ] â• æ·»åŠ ç¤¾ç¾¤é€£çµé¡¯ç¤ºå€å¡Š
  - [ ] â• æ ¹æ“š `isSelf` prop åˆ¤æ–·æ˜¯å¦ç‚ºæœ¬äºº
  - [ ] â• æ ¹æ“š `isFriend` prop åˆ¤æ–·æ˜¯å¦ç‚ºå¥½å‹
  - [ ] â• å‚³é `socialLinks` å’Œ `socialPrivacy` è³‡æ–™

### Phase 6: æ¨£å¼èˆ‡ UX å„ªåŒ–

- [ ] **Task 11: å¯¦ä½œçµ„ä»¶æ¨£å¼** (AC: 18, 25, 26, 27)
  - [ ] â• è¨­è¨ˆç¤¾ç¾¤é€£çµè¡¨å–®æ¨£å¼
  - [ ] â• è¨­è¨ˆç¤¾ç¾¤é€£çµåœ–ç¤ºæ¨£å¼ï¼ˆä½¿ç”¨ Element Plus Icons æˆ–è‡ªè¨‚ SVGï¼‰
  - [ ] â• å¯¦ä½œæ¸…é™¤æŒ‰éˆ•æ¨£å¼
  - [ ] â• å¯¦ä½œéŸ¿æ‡‰å¼è¨­è¨ˆï¼ˆæ‰‹æ©Ÿã€å¹³æ¿ã€æ¡Œé¢ï¼‰
  - [ ] â• è¨­è¨ˆéš±ç§æç¤ºæ¨£å¼

- [ ] **Task 12: ç¤¾ç¾¤åœ–ç¤ºæ•´åˆ** (AC: 25)
  - [ ] â• å¾ `@element-plus/icons-vue` æˆ–å®‰è£ç¤¾ç¾¤åœ–ç¤ºå¥—ä»¶ï¼ˆä¾‹å¦‚ï¼š`@vicons/fa` æˆ– `@iconify/vue`ï¼‰
  - [ ] â• æ•´åˆ Instagram, Facebook, Line, Twitter åœ–ç¤º
  - [ ] â• ç¢ºä¿åœ–ç¤ºæ¸…æ™°å¯è¾¨è­˜

### Phase 7: æ¸¬è©¦èˆ‡é©—è­‰

- [ ] **Task 13: å‰ç«¯æ¸¬è©¦å»ºç«‹** (AC: 5, 6, 7, 8, 14, 15)
  - [ ] â• åœ¨ `frontend/tests/unit/components/` å»ºç«‹ `SocialLinksEditor.spec.js`
  - [ ] â• å¯¦ä½œæ¸¬è©¦æ¡ˆä¾‹ï¼š
    - [ ] æ¸¬è©¦çµ„ä»¶æ­£ç¢ºæ¸²æŸ“
    - [ ] æ¸¬è©¦ Instagram URL é©—è­‰
    - [ ] æ¸¬è©¦ Facebook URL é©—è­‰
    - [ ] æ¸¬è©¦ Line ID é©—è­‰
    - [ ] æ¸¬è©¦ Twitter URL é©—è­‰
    - [ ] æ¸¬è©¦éš±ç§è¨­å®šåˆ‡æ›
    - [ ] æ¸¬è©¦å„²å­˜æˆåŠŸæµç¨‹ï¼ˆMock APIï¼‰
    - [ ] æ¸¬è©¦å„²å­˜å¤±æ•—è™•ç†
  - [ ] â• åœ¨ `frontend/tests/unit/components/` å»ºç«‹ `SocialLinksDisplay.spec.js`
  - [ ] â• å¯¦ä½œæ¸¬è©¦æ¡ˆä¾‹ï¼š
    - [ ] æ¸¬è©¦çµ„ä»¶æ­£ç¢ºæ¸²æŸ“
    - [ ] æ¸¬è©¦éš±ç§é‚è¼¯ï¼ˆå…¬é–‹ã€åƒ…å¥½å‹ï¼‰
    - [ ] æ¸¬è©¦æœ¬äººæŸ¥çœ‹é¡¯ç¤ºæ‰€æœ‰é€£çµ
    - [ ] æ¸¬è©¦éå¥½å‹æŸ¥çœ‹åƒ…å¥½å‹è¨­å®šæ™‚é¡¯ç¤ºæç¤º
    - [ ] æ¸¬è©¦æœªè¨­å®šç¤¾ç¾¤é€£çµæ™‚çš„é¡¯ç¤º
  - [ ] ğŸ§ª åŸ·è¡Œæ¸¬è©¦ï¼š`npm run test:unit`
  - [ ] ğŸ“Š ç¢ºèªè¦†è“‹ç‡ > 80%

- [ ] **Task 14: å¾Œç«¯æ¸¬è©¦è£œå……** (AC: 14, 28, 29)
  - [ ] âœ… ç¢ºèª `backend/tests/test_users.py` å­˜åœ¨
  - [ ] â• è‹¥ç¼ºå¤±ï¼Œæ·»åŠ æ¸¬è©¦æ¡ˆä¾‹ï¼š
    - [ ] æ¸¬è©¦æˆåŠŸæ›´æ–°ç¤¾ç¾¤é€£çµ
    - [ ] æ¸¬è©¦æœªèªè­‰è«‹æ±‚è¿”å› 401
    - [ ] æ¸¬è©¦æ›´æ–°ä»–äººç¤¾ç¾¤é€£çµè¿”å› 403 æˆ–éŒ¯èª¤
    - [ ] æ¸¬è©¦éš±ç§è¨­å®šæ›´æ–°
    - [ ] æ¸¬è©¦ç¤¾ç¾¤é€£çµéš±ç§é¡¯ç¤ºé‚è¼¯
  - [ ] ğŸ§ª åŸ·è¡Œæ¸¬è©¦ï¼š`pytest backend/tests/test_users.py -v`
  - [ ] ğŸ“Š ç¢ºèªæ‰€æœ‰æ¸¬è©¦é€šé

### Phase 8: æ•´åˆæ¸¬è©¦

- [ ] **Task 15: ç«¯åˆ°ç«¯åŠŸèƒ½é©—è­‰** (æ‰€æœ‰ AC)
  - [ ] ğŸ§ª æ‰‹å‹•æ¸¬è©¦æ¸…å–®ï¼š
    - [ ] **æ¸¬è©¦ 1**: è¨ªå•å€‹äººè³‡æ–™ç·¨è¼¯é é¢
      - ç™»å…¥å¸³è™Ÿ
      - è¨ªå•å€‹äººè³‡æ–™ç·¨è¼¯é é¢
      - é©—è­‰ï¼šé¡¯ç¤ºç¤¾ç¾¤é€£çµç·¨è¼¯å€å¡Š
      - é©—è­‰ï¼šé¡¯ç¤ºéš±ç§è¨­å®šé¸é …
    - [ ] **æ¸¬è©¦ 2**: å¡«å¯«ç¤¾ç¾¤é€£çµ
      - å¡«å¯« Instagram URL
      - å¡«å¯« Facebook URL
      - å¡«å¯« Line ID
      - å¡«å¯« Twitter URL
      - é©—è­‰ï¼šæ‰€æœ‰æ¬„ä½æ­£å¸¸è¼¸å…¥
    - [ ] **æ¸¬è©¦ 3**: è¡¨å–®é©—è­‰
      - è¼¸å…¥ç„¡æ•ˆçš„ Instagram URL
      - é©—è­‰ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      - è¼¸å…¥ç„¡æ•ˆçš„ Facebook URL
      - é©—è­‰ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      - è¼¸å…¥ç„¡æ•ˆçš„ Line ID
      - é©—è­‰ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      - è¼¸å…¥ç„¡æ•ˆçš„ Twitter URL
      - é©—è­‰ï¼šé¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
    - [ ] **æ¸¬è©¦ 4**: éš±ç§è¨­å®š
      - é¸æ“‡ã€Œå…¬é–‹ã€
      - é©—è­‰ï¼šéš±ç§è¨­å®šæ›´æ–°
      - é¸æ“‡ã€Œåƒ…å¥½å‹ã€
      - é©—è­‰ï¼šéš±ç§è¨­å®šæ›´æ–°
    - [ ] **æ¸¬è©¦ 5**: å„²å­˜ç¤¾ç¾¤é€£çµ
      - å¡«å¯«æœ‰æ•ˆçš„ç¤¾ç¾¤é€£çµ
      - é»æ“Šã€Œå„²å­˜ã€æŒ‰éˆ•
      - é©—è­‰ï¼šé¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
      - é©—è­‰ï¼šé¡¯ç¤ºæˆåŠŸè¨Šæ¯
      - é©—è­‰ï¼šç¤¾ç¾¤é€£çµå·²å„²å­˜
    - [ ] **æ¸¬è©¦ 6**: ç¤¾ç¾¤é€£çµé¡¯ç¤ºï¼ˆæœ¬äººæŸ¥çœ‹ï¼‰
      - è¨ªå•è‡ªå·±çš„å€‹äººè³‡æ–™é é¢
      - é©—è­‰ï¼šé¡¯ç¤ºæ‰€æœ‰å·²å„²å­˜çš„ç¤¾ç¾¤é€£çµ
      - é©—è­‰ï¼šé»æ“Šé€£çµåœ¨æ–°åˆ†é é–‹å•Ÿ
      - é©—è­‰ï¼šæœªå¡«å¯«çš„é€£çµä¸é¡¯ç¤º
    - [ ] **æ¸¬è©¦ 7**: ç¤¾ç¾¤é€£çµé¡¯ç¤ºï¼ˆå…¬é–‹è¨­å®šï¼‰
      - è¨­å®šéš±ç§ç‚ºã€Œå…¬é–‹ã€
      - ä½¿ç”¨å¦ä¸€å¸³è™ŸæŸ¥çœ‹å€‹äººè³‡æ–™
      - é©—è­‰ï¼šéå¥½å‹å¯ä»¥çœ‹åˆ°ç¤¾ç¾¤é€£çµ
    - [ ] **æ¸¬è©¦ 8**: ç¤¾ç¾¤é€£çµé¡¯ç¤ºï¼ˆåƒ…å¥½å‹è¨­å®šï¼‰
      - è¨­å®šéš±ç§ç‚ºã€Œåƒ…å¥½å‹ã€
      - ä½¿ç”¨éå¥½å‹å¸³è™ŸæŸ¥çœ‹å€‹äººè³‡æ–™
      - é©—è­‰ï¼šé¡¯ç¤ºã€Œæ­¤ç”¨æˆ¶çš„ç¤¾ç¾¤é€£çµåƒ…å°å¥½å‹å…¬é–‹ã€
      - ä½¿ç”¨å¥½å‹å¸³è™ŸæŸ¥çœ‹å€‹äººè³‡æ–™
      - é©—è­‰ï¼šå¯ä»¥çœ‹åˆ°ç¤¾ç¾¤é€£çµ
    - [ ] **æ¸¬è©¦ 9**: æ¸…é™¤åŠŸèƒ½
      - å¡«å¯«ç¤¾ç¾¤é€£çµ
      - é»æ“Šæ¸…é™¤æŒ‰éˆ•
      - é©—è­‰ï¼šæ¬„ä½æ¸…ç©º
    - [ ] **æ¸¬è©¦ 10**: éŸ¿æ‡‰å¼è¨­è¨ˆ
      - åœ¨æ¡Œé¢æ¨¡å¼æŸ¥çœ‹
      - é©—è­‰ï¼šä½ˆå±€æ­£ç¢º
      - åœ¨æ‰‹æ©Ÿæ¨¡å¼æŸ¥çœ‹
      - é©—è­‰ï¼šä½ˆå±€æ­£ç¢º
    - [ ] **æ¸¬è©¦ 11**: èªè­‰ä¿è­·
      - ç™»å‡ºç‹€æ…‹å˜—è©¦æ›´æ–°ç¤¾ç¾¤é€£çµ
      - é©—è­‰ï¼šè‡ªå‹•è·³è½‰è‡³ç™»å…¥é æˆ–é¡¯ç¤ºéŒ¯èª¤
    - [ ] **æ¸¬è©¦ 12**: æ•ˆèƒ½æ¸¬è©¦
      - ä½¿ç”¨ DevTools Network é¢æ¿
      - é©—è­‰ï¼šAPI å›æ‡‰æ™‚é–“ < 2000ms
  - [ ] ğŸ“Š é©—è­‰æ‰€æœ‰ AC æ»¿è¶³
  - [ ] ğŸ“ è¨˜éŒ„æ‰€æœ‰æ¸¬è©¦çµæœ

### åœ–ä¾‹èªªæ˜
- âœ… **å·²å­˜åœ¨ä¸”æ­£ç¢º** - é©—è­‰é€šéå³å¯
- âš ï¸ **éœ€è¦æª¢æŸ¥** - å¯èƒ½éœ€è¦èª¿æ•´
- â• **éœ€è¦æ–°å¢** - ç¼ºå¤±çš„åŠŸèƒ½
- ğŸ”„ **éœ€è¦é‡æ§‹** - éœ€è¦æ”¹é€²ç¾æœ‰å¯¦ä½œ
- ğŸ“ **è¨˜éŒ„** - æ–‡ä»¶åŒ–ç™¼ç¾
- ğŸ§ª **æ¸¬è©¦** - åŸ·è¡Œæ¸¬è©¦
- ğŸ“Š **é©—è­‰** - ç¢ºèªç¬¦åˆéœ€æ±‚

## Dev Notes

### Previous Story Insights

**ä¾†è‡ª Story 1.1 - 2.2 çš„ç¶“é©—**ï¼š
- âœ… Vue 3 Composition API æ˜¯æ¨™æº–é–‹ç™¼æ¨¡å¼
- âœ… Element Plus çµ„ä»¶åº«å·²æ•´åˆä¸”é‹ä½œè‰¯å¥½
- âœ… Pinia Auth Store å·²å»ºç«‹ï¼Œç”¨æ–¼ç®¡ç†èªè­‰ç‹€æ…‹
- âœ… JWT èªè­‰æ©Ÿåˆ¶å®Œå–„ï¼ˆ`@jwt_required()` è£é£¾å™¨ï¼‰
- âœ… Axios æ””æˆªå™¨å·²é…ç½®ï¼Œè™•ç†èªè­‰å’ŒéŒ¯èª¤
- âœ… è·¯ç”±å®ˆè¡›æ©Ÿåˆ¶å·²å»ºç«‹ï¼ˆ`requiresAuth` metaï¼‰
- âœ… éŸ¿æ‡‰å¼è¨­è¨ˆæ¨¡å¼å·²ç¢ºç«‹
- âœ… éŒ¯èª¤è™•ç†æ¨¡å¼ï¼šå¾Œç«¯è¿”å›å…·é«”éŒ¯èª¤ï¼Œå‰ç«¯é¡¯ç¤ºå‹å–„è¨Šæ¯
- âœ… è¡¨å–®é©—è­‰æ¨¡å¼ï¼šä½¿ç”¨ `el-form` çš„ `rules` å±¬æ€§å’Œè‡ªè¨‚é©—è­‰å‡½æ•¸

**Brownfield å°ˆæ¡ˆèƒŒæ™¯**ï¼š
- å¾Œç«¯ User Model å·²åŒ…å«ç¤¾ç¾¤é€£çµæ¬„ä½å’Œéš±ç§è¨­å®š
- `PUT /api/users/profile` ç«¯é»å·²æ”¯æ´æ›´æ–°ç¤¾ç¾¤é€£çµ
- `PUT /api/users/privacy` ç«¯é»å·²æ”¯æ´æ›´æ–°éš±ç§è¨­å®š
- `to_dict()` æ–¹æ³•å·²å¯¦ä½œéš±ç§é‚è¼¯ï¼ˆæ ¹æ“š `social_privacy` å’Œ `is_friend` æ±ºå®šæ˜¯å¦è¿”å›ç¤¾ç¾¤é€£çµï¼‰
- ä¸»è¦å·¥ä½œæ˜¯**å»ºç«‹å‰ç«¯ç¤¾ç¾¤é€£çµç·¨è¼¯çµ„ä»¶**å’Œ**é¡¯ç¤ºçµ„ä»¶**
- éœ€è¦å¯¦ä½œ**è¡¨å–®é©—è­‰**å’Œ**éš±ç§æ§åˆ¶é‚è¼¯**

### Data Models

**User Model** [Source: backend/models/user.py]
- **Table**: `users`
- **Primary Key**: `user_id` (Integer, Auto-increment)
- **ç¤¾ç¾¤é€£çµæ¬„ä½**:
  - `instagram_url` (String(255)) - Instagram å€‹äººé é¢ URL
  - `facebook_url` (String(255)) - Facebook å€‹äººé é¢ URL
  - `line_id` (String(100)) - Line ID
  - `twitter_url` (String(255)) - Twitter å€‹äººé é¢ URL
  - `social_privacy` (String(20), DEFAULT 'public') - ç¤¾ç¾¤é€£çµéš±ç§è¨­å®š
    - å€¼ï¼š`'public'` (å…¬é–‹) æˆ– `'friends_only'` (åƒ…å¥½å‹)
- **å…¶ä»–ç›¸é—œæ¬„ä½**:
  - `name` (String(100), NOT NULL) - å§“å
  - `email` (String(120), UNIQUE, NOT NULL) - é›»å­éƒµä»¶
  - `profile_picture` (String(255)) - é ­åƒåœ–ç‰‡ URL
  - `bio` (Text) - å€‹äººç°¡ä»‹

**Match Model** [ç”¨æ–¼åˆ¤æ–·å¥½å‹é—œä¿‚]
- **Table**: `matches`
- **ç›¸é—œæ¬„ä½**:
  - `user_a` (Integer, Foreign Key to users.user_id)
  - `user_b` (Integer, Foreign Key to users.user_id)
  - `status` (String(20)) - åª’åˆç‹€æ…‹
    - å€¼ï¼š`'pending'`, `'accepted'`, `'confirmed'`, `'rejected'`
- **å¥½å‹é—œä¿‚åˆ¤æ–·**: `Match.status` ç‚º `'accepted'` æˆ– `'confirmed'` æ™‚è¦–ç‚ºå¥½å‹

### API Specifications

**Endpoint 1**: `GET /api/users/profile` [Source: backend/blueprints/users.py:67-86]

**Authentication**: Required (JWT Token)

**Request Headers**:
```
Authorization: Bearer <JWT_TOKEN>
```

**Response (Success - 200)**:
```json
{
  "user": {
    "user_id": 1,
    "name": "John Doe",
    "email": "john@example.com",
    "profile_picture": "/uploads/avatar.jpg",
    "avatar": "/uploads/avatar.jpg",
    "bio": "Travel enthusiast",
    "gender": "male",
    "age": 28,
    "interests": ["hiking", "photography"],
    "social_links": {
      "instagram": "https://instagram.com/johndoe",
      "facebook": "https://facebook.com/johndoe",
      "line": "johndoe_line",
      "twitter": "https://twitter.com/johndoe"
    },
    "privacy_setting": "public",
    "social_privacy": "public",
    "join_date": "2025-11-01T10:00:00",
    "is_verified": true,
    "is_active": true
  }
}
```

**Note**: ç•¶æŸ¥çœ‹è‡ªå·±çš„è³‡æ–™æ™‚ï¼Œ`include_private=True`ï¼Œæœƒè¿”å›å®Œæ•´çš„ç¤¾ç¾¤é€£çµè³‡è¨Šã€‚

---

**Endpoint 2**: `GET /api/users/<user_id>` [Source: backend/blueprints/users.py:185-260]

**Authentication**: Required (JWT Token)

**Response (Success - 200)**:
```json
{
  "user": {
    "user_id": 2,
    "name": "Jane Smith",
    "profile_picture": "/uploads/avatar2.jpg",
    "avatar": "/uploads/avatar2.jpg",
    "bio": "Adventure seeker",
    "gender": "female",
    "age": 25,
    "interests": ["travel", "cooking"],
    "social_links": {
      "instagram": "https://instagram.com/janesmith",
      "facebook": "https://facebook.com/janesmith",
      "line": "janesmith_line",
      "twitter": null
    },
    "join_date": "2025-10-15T08:30:00",
    "is_verified": true,
    "stats": {
      "activities": 5,
      "matches": 3,
      "reviews": 8
    }
  }
}
```

**éš±ç§é‚è¼¯** [Source: backend/models/user.py:67-94]:
- **æœ¬äººæŸ¥çœ‹** (`include_private=True`): è¿”å›æ‰€æœ‰ç¤¾ç¾¤é€£çµ
- **ç¤¾ç¾¤éš±ç§ç‚º `public`**: æ‰€æœ‰ç”¨æˆ¶å¯ä»¥çœ‹åˆ°ç¤¾ç¾¤é€£çµ
- **ç¤¾ç¾¤éš±ç§ç‚º `friends_only`**: åªæœ‰å¥½å‹ (`is_friend=True`) å¯ä»¥çœ‹åˆ°ç¤¾ç¾¤é€£çµ
- **éæœ¬äººä¸”éå¥½å‹**: è¿”å› `null` å€¼çš„ `social_links`

---

**Endpoint 3**: `PUT /api/users/profile` [Source: backend/blueprints/users.py:88-135]

**Authentication**: Required (JWT Token)

**Request Headers**:
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

**Request Body**:
```json
{
  "name": "John Doe",
  "bio": "Travel enthusiast",
  "social_links": {
    "instagram": "https://instagram.com/johndoe",
    "facebook": "https://facebook.com/johndoe",
    "line": "johndoe_line",
    "twitter": "https://twitter.com/johndoe"
  }
}
```

**Response (Success - 200)**:
```json
{
  "message": "å€‹äººè³‡æ–™æ›´æ–°æˆåŠŸ",
  "user": {
    "user_id": 1,
    "name": "John Doe",
    "email": "john@example.com",
    "bio": "Travel enthusiast",
    "social_links": {
      "instagram": "https://instagram.com/johndoe",
      "facebook": "https://facebook.com/johndoe",
      "line": "johndoe_line",
      "twitter": "https://twitter.com/johndoe"
    },
    ...
  }
}
```

**å¾Œç«¯é‚è¼¯** [Source: backend/blueprints/users.py:116-126]:
```python
# æ›´æ–°ç¤¾ç¾¤å¸³è™Ÿ
if 'social_links' in data:
    social = data['social_links']
    if 'instagram' in social:
        user.instagram_url = social['instagram']
    if 'facebook' in social:
        user.facebook_url = social['facebook']
    if 'line' in social:
        user.line_id = social['line']
    if 'twitter' in social:
        user.twitter_url = social['twitter']
```

---

**Endpoint 4**: `PUT /api/users/privacy` [Source: backend/blueprints/users.py:137-169]

**Authentication**: Required (JWT Token)

**Request Headers**:
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

**Request Body**:
```json
{
  "social_privacy": "friends_only"
}
```

**Response (Success - 200)**:
```json
{
  "message": "éš±ç§è¨­å®šå·²æ›´æ–°",
  "privacy_setting": "public",
  "social_privacy": "friends_only"
}
```

**Response (Error - 400)**:
```json
{
  "error": "ç„¡æ•ˆçš„ç¤¾ç¾¤éš±ç§è¨­å®šå€¼"
}
```

**é©—è­‰é‚è¼¯** [Source: backend/blueprints/users.py:152-157]:
```python
if 'social_privacy' in data:
    # é©—è­‰å€¼æ˜¯å¦æœ‰æ•ˆ
    if data['social_privacy'] in ['public', 'friends_only']:
        user.social_privacy = data['social_privacy']
    else:
        return jsonify({'error': 'ç„¡æ•ˆçš„ç¤¾ç¾¤éš±ç§è¨­å®šå€¼'}), 400
```

### Component Specifications

**SocialLinksEditor.vue Component** [æ–°å»ºç«‹]

- **Location**: `frontend/src/components/SocialLinksEditor.vue`
- **Type**: Reusable Component (Vue 3 SFC with Composition API)
- **Purpose**: æä¾›ç¤¾ç¾¤é€£çµç·¨è¼¯åŠŸèƒ½ï¼ŒåŒ…å«è¡¨å–®é©—è­‰å’Œéš±ç§è¨­å®š

**å»ºè­°çµæ§‹**:
```vue
<template>
  <div class="social-links-editor">
    <h3>ç¤¾ç¾¤é€£çµ</h3>
    
    <el-form 
      ref="formRef" 
      :model="formData" 
      :rules="rules"
      label-width="120px"
    >
      <!-- Instagram -->
      <el-form-item label="Instagram" prop="instagram">
        <el-input 
          v-model="formData.instagram" 
          placeholder="https://instagram.com/username"
          clearable
        >
          <template #prefix>
            <el-icon><BrandInstagram /></el-icon>
          </template>
        </el-input>
      </el-form-item>
      
      <!-- Facebook -->
      <el-form-item label="Facebook" prop="facebook">
        <el-input 
          v-model="formData.facebook" 
          placeholder="https://facebook.com/username"
          clearable
        >
          <template #prefix>
            <el-icon><BrandFacebook /></el-icon>
          </template>
        </el-input>
      </el-form-item>
      
      <!-- Line ID -->
      <el-form-item label="Line ID" prop="line">
        <el-input 
          v-model="formData.line" 
          placeholder="yourlineid"
          clearable
        >
          <template #prefix>
            <el-icon><BrandLine /></el-icon>
          </template>
        </el-input>
      </el-form-item>
      
      <!-- Twitter -->
      <el-form-item label="Twitter" prop="twitter">
        <el-input 
          v-model="formData.twitter" 
          placeholder="https://twitter.com/username"
          clearable
        >
          <template #prefix>
            <el-icon><BrandTwitter /></el-icon>
          </template>
        </el-input>
      </el-form-item>
      
      <!-- éš±ç§è¨­å®š -->
      <el-form-item label="éš±ç§è¨­å®š">
        <el-radio-group v-model="socialPrivacy">
          <el-radio label="public">
            å…¬é–‹
            <span class="privacy-hint">æ‰€æœ‰ç”¨æˆ¶éƒ½å¯ä»¥çœ‹åˆ°æˆ‘çš„ç¤¾ç¾¤é€£çµ</span>
          </el-radio>
          <el-radio label="friends_only">
            åƒ…å¥½å‹
            <span class="privacy-hint">åªæœ‰å·²åª’åˆæˆåŠŸçš„å¥½å‹å¯ä»¥çœ‹åˆ°</span>
          </el-radio>
        </el-radio-group>
      </el-form-item>
      
      <!-- å„²å­˜æŒ‰éˆ• -->
      <el-form-item>
        <el-button type="primary" @click="handleSave" :loading="loading">
          å„²å­˜
        </el-button>
      </el-form-item>
    </el-form>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue'
import { ElMessage } from 'element-plus'
import { updateProfile, updatePrivacy } from '@/api/users'
import { 
  validateInstagramUrl, 
  validateFacebookUrl, 
  validateLineId, 
  validateTwitterUrl 
} from '@/utils/validators'

// Props
const props = defineProps({
  initialSocialLinks: {
    type: Object,
    default: () => ({})
  },
  initialPrivacy: {
    type: String,
    default: 'public'
  }
})

// Emits
const emit = defineEmits(['update-success'])

// Refs
const formRef = ref(null)
const loading = ref(false)
const socialPrivacy = ref(props.initialPrivacy)

// Form Data
const formData = reactive({
  instagram: props.initialSocialLinks.instagram || '',
  facebook: props.initialSocialLinks.facebook || '',
  line: props.initialSocialLinks.line || '',
  twitter: props.initialSocialLinks.twitter || ''
})

// Validation Rules
const rules = {
  instagram: [{ validator: validateInstagramUrl, trigger: 'blur' }],
  facebook: [{ validator: validateFacebookUrl, trigger: 'blur' }],
  line: [{ validator: validateLineId, trigger: 'blur' }],
  twitter: [{ validator: validateTwitterUrl, trigger: 'blur' }]
}

// Methods
const handleSave = async () => {
  try {
    // é©—è­‰è¡¨å–®
    await formRef.value.validate()
    
    loading.value = true
    
    // æ›´æ–°ç¤¾ç¾¤é€£çµ
    await updateProfile({
      social_links: {
        instagram: formData.instagram,
        facebook: formData.facebook,
        line: formData.line,
        twitter: formData.twitter
      }
    })
    
    // æ›´æ–°éš±ç§è¨­å®š
    await updatePrivacy({
      social_privacy: socialPrivacy.value
    })
    
    ElMessage.success('ç¤¾ç¾¤é€£çµå·²æ›´æ–°ï¼')
    emit('update-success')
    
  } catch (error) {
    if (error.message !== 'Validation failed') {
      console.error('æ›´æ–°ç¤¾ç¾¤é€£çµå¤±æ•—:', error)
      ElMessage.error('æ›´æ–°å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦')
    }
  } finally {
    loading.value = false
  }
}
</script>

<style lang="scss" scoped>
.social-links-editor {
  .privacy-hint {
    display: block;
    font-size: var(--font-size-small);
    color: var(--el-text-color-secondary);
    margin-top: var(--spacing-xs);
  }
  
  :deep(.el-form-item__label) {
    font-weight: 600;
  }
}
</style>
```

---

**SocialLinksDisplay.vue Component** [æ–°å»ºç«‹]

- **Location**: `frontend/src/components/SocialLinksDisplay.vue`
- **Type**: Reusable Component (é¡¯ç¤ºç¤¾ç¾¤é€£çµ)
- **Purpose**: æ ¹æ“šéš±ç§è¨­å®šé¡¯ç¤ºç¤¾ç¾¤é€£çµ

**å»ºè­°çµæ§‹**: (åƒè¦‹ Task 8)

### File Locations

Based on [Source: architecture/3-å°ˆæ¡ˆçµæ§‹-project-structure.md]:

**Frontend**:
- ç¤¾ç¾¤é€£çµç·¨è¼¯çµ„ä»¶: `frontend/src/components/SocialLinksEditor.vue` (æ–°å»º)
- ç¤¾ç¾¤é€£çµé¡¯ç¤ºçµ„ä»¶: `frontend/src/components/SocialLinksDisplay.vue` (æ–°å»º)
- é©—è­‰å·¥å…·: `frontend/src/utils/validators.js` (æ“´å±• - æ·»åŠ ç¤¾ç¾¤é€£çµé©—è­‰å‡½æ•¸)
- Users API æœå‹™: `frontend/src/api/users.js` (å·²å­˜åœ¨ - ç¢ºèª updateProfile å’Œ updatePrivacy)
- å€‹äººè³‡æ–™ç·¨è¼¯é é¢: `frontend/src/views/ProfileEdit.vue` (æ•´åˆ SocialLinksEditor)
- å€‹äººè³‡æ–™é é¢: `frontend/src/views/Profile.vue` (æ•´åˆ SocialLinksDisplay)
- å‰ç«¯æ¸¬è©¦: `frontend/tests/unit/components/SocialLinksEditor.spec.js` (æ–°å»º)
- å‰ç«¯æ¸¬è©¦: `frontend/tests/unit/components/SocialLinksDisplay.spec.js` (æ–°å»º)

**Backend**:
- User Model: `backend/models/user.py` (å·²å­˜åœ¨ - ç¢ºèªç¤¾ç¾¤é€£çµæ¬„ä½å’Œéš±ç§é‚è¼¯)
- Users Blueprint: `backend/blueprints/users.py` (å·²å­˜åœ¨ - ç¢ºèª update_profile å’Œ update_privacy ç«¯é»)
- å¾Œç«¯æ¸¬è©¦: `backend/tests/test_users.py` (æ–°å»ºæˆ–ç¢ºèª)

### Testing Requirements

Based on [Source: architecture/11-æ¸¬è©¦ç­–ç•¥-testing-requirements.md]:

**Unit Testing (Vitest)**:
- **Location**: `frontend/tests/unit/components/SocialLinksEditor.spec.js`, `SocialLinksDisplay.spec.js`
- **Framework**: Vitest + @vue/test-utils + Element Plus
- **Coverage Target**: 80%+
- **Test Cases**:
  1. **SocialLinksEditor**:
     - çµ„ä»¶æ­£ç¢ºæ¸²æŸ“
     - Instagram URL é©—è­‰ï¼ˆæœ‰æ•ˆ/ç„¡æ•ˆï¼‰
     - Facebook URL é©—è­‰ï¼ˆæœ‰æ•ˆ/ç„¡æ•ˆï¼‰
     - Line ID é©—è­‰ï¼ˆæœ‰æ•ˆ/ç„¡æ•ˆï¼‰
     - Twitter URL é©—è­‰ï¼ˆæœ‰æ•ˆ/ç„¡æ•ˆï¼‰
     - éš±ç§è¨­å®šåˆ‡æ›
     - å„²å­˜æˆåŠŸæµç¨‹ï¼ˆMock APIï¼‰
     - å„²å­˜å¤±æ•—è™•ç†
     - æ¸…é™¤æŒ‰éˆ•åŠŸèƒ½
  2. **SocialLinksDisplay**:
     - çµ„ä»¶æ­£ç¢ºæ¸²æŸ“
     - é¡¯ç¤ºå·²è¨­å®šçš„ç¤¾ç¾¤é€£çµ
     - æœ¬äººæŸ¥çœ‹é¡¯ç¤ºæ‰€æœ‰é€£çµ
     - å…¬é–‹è¨­å®šæ‰€æœ‰äººå¯è¦‹
     - åƒ…å¥½å‹è¨­å®šéå¥½å‹ä¸å¯è¦‹
     - åƒ…å¥½å‹è¨­å®šå¥½å‹å¯è¦‹
     - æœªè¨­å®šç¤¾ç¾¤é€£çµæ™‚é¡¯ç¤ºæç¤º

**Backend Testing (pytest)**:
- **Location**: `backend/tests/test_users.py`
- **Framework**: pytest + pytest-flask
- **Test Cases**:
  1. æ¸¬è©¦æˆåŠŸæ›´æ–°ç¤¾ç¾¤é€£çµ
  2. æ¸¬è©¦æœªèªè­‰è«‹æ±‚è¿”å› 401
  3. æ¸¬è©¦éš±ç§è¨­å®šæ›´æ–°
  4. æ¸¬è©¦ç„¡æ•ˆçš„éš±ç§è¨­å®šå€¼è¿”å› 400
  5. æ¸¬è©¦ç¤¾ç¾¤é€£çµéš±ç§é¡¯ç¤ºé‚è¼¯ï¼ˆå…¬é–‹/åƒ…å¥½å‹ï¼‰
  6. æ¸¬è©¦å¥½å‹é—œä¿‚åˆ¤æ–·é‚è¼¯

**Running Tests**:
```bash
# Frontend
npm run test:unit

# Backend
pytest backend/tests/test_users.py -v
```

### Technical Constraints

[Source: architecture/2-å‰ç«¯æŠ€è¡“æ£§-frontend-tech-stack.md]

1. **Framework Versions**:
   - Vue.js 3.3.8+
   - Element Plus 2.4.2+
   - Axios 1.6.0+ (HTTP è«‹æ±‚)

2. **Performance Requirements**:
   - API å›æ‡‰æ™‚é–“ < 2000ms

3. **UI/UX Requirements**:
   - éŸ¿æ‡‰å¼è¨­è¨ˆï¼šæ¡Œé¢ã€å¹³æ¿ã€æ‰‹æ©Ÿ
   - ä½¿ç”¨ Element Plus Form çµ„ä»¶
   - éŒ¯èª¤è¨Šæ¯æ‡‰æ¸…æ™°ä¸”å…·é«”
   - æä¾›æ¸…é™¤æŒ‰éˆ•

4. **Browser Support**:
   - Chrome 90+, Firefox 88+, Safari 14+, Edge 90+

5. **Authentication**:
   - æ‰€æœ‰ API éœ€ JWT èªè­‰
   - åªèƒ½æ›´æ–°è‡ªå·±çš„ç¤¾ç¾¤é€£çµ

6. **Validation**:
   - Instagram URL: `^(https?://)?((www|m)\.)?instagram\.com/[\w.]+/?$`
   - Facebook URL: `^(https?://)?(www\.)?facebook\.com/[\w.]+/?$`
   - Line ID: `^[a-zA-Z0-9._-]{4,20}$`
   - Twitter URL: `^(https?://)?(www\.)?(twitter\.com|x\.com)/[\w]+/?$`

### Project Structure Notes

[Source: architecture/3-å°ˆæ¡ˆçµæ§‹-project-structure.md]

**æ–°å¢ç›®éŒ„/æª”æ¡ˆ**:
- âœ… `frontend/src/components/SocialLinksEditor.vue` - ç¤¾ç¾¤é€£çµç·¨è¼¯çµ„ä»¶ï¼ˆæ–°å»ºï¼‰
- âœ… `frontend/src/components/SocialLinksDisplay.vue` - ç¤¾ç¾¤é€£çµé¡¯ç¤ºçµ„ä»¶ï¼ˆæ–°å»ºï¼‰
- âœ… `frontend/tests/unit/components/SocialLinksEditor.spec.js` - å–®å…ƒæ¸¬è©¦ï¼ˆæ–°å»ºï¼‰
- âœ… `frontend/tests/unit/components/SocialLinksDisplay.spec.js` - å–®å…ƒæ¸¬è©¦ï¼ˆæ–°å»ºï¼‰
- âœ… `backend/tests/test_users.py` - å¾Œç«¯æ¸¬è©¦ï¼ˆæ–°å»ºæˆ–ç¢ºèªï¼‰

**ä¿®æ”¹æª”æ¡ˆ**:
- âœ… `frontend/src/utils/validators.js` - æ·»åŠ ç¤¾ç¾¤é€£çµé©—è­‰å‡½æ•¸
- âœ… `frontend/src/api/users.js` - ç¢ºèª updateProfile å’Œ updatePrivacy å‡½æ•¸
- âœ… `frontend/src/views/ProfileEdit.vue` - æ•´åˆ SocialLinksEditor
- âœ… `frontend/src/views/Profile.vue` - æ•´åˆ SocialLinksDisplay

**ç„¡çµæ§‹è¡çª**ï¼šæ‰€æœ‰æ–°å¢æª”æ¡ˆç¬¦åˆç¾æœ‰å°ˆæ¡ˆçµæ§‹ã€‚

### Additional Notes

**ç¤¾ç¾¤é€£çµé©—è­‰æœ€ä½³å¯¦è¸**ï¼š
1. ä½¿ç”¨æ­£è¦è¡¨ç¤ºå¼é©—è­‰ URL æ ¼å¼
2. é©—è­‰å‡½æ•¸æ‡‰æ”¯æ´é¸å¡«ï¼ˆç©ºå€¼æ™‚é€šéé©—è­‰ï¼‰
3. éŒ¯èª¤è¨Šæ¯æ‡‰æ¸…æ™°å…·é«”
4. Line ID é©—è­‰ï¼šå…è¨±å­—æ¯ã€æ•¸å­—ã€é»è™Ÿã€åº•ç·šã€æ¸›è™Ÿï¼Œé•·åº¦ 4-20 å­—å…ƒ

**éš±ç§æ§åˆ¶é‚è¼¯**ï¼š
1. å¾Œç«¯ `to_dict()` æ–¹æ³•å·²å¯¦ä½œéš±ç§é‚è¼¯
2. å‰ç«¯é¡¯ç¤ºçµ„ä»¶éœ€æ ¹æ“š `isSelf`, `isFriend`, `socialPrivacy` åˆ¤æ–·æ˜¯å¦é¡¯ç¤º
3. å¥½å‹é—œä¿‚åˆ¤æ–·ï¼š`Match.status` ç‚º `'accepted'` æˆ– `'confirmed'`

**ç¤¾ç¾¤é€£çµé¡¯ç¤ºæœ€ä½³å¯¦è¸**ï¼š
1. ä½¿ç”¨åœ–ç¤º + æ–‡å­—æ¨™ç±¤
2. é»æ“Šé€£çµåœ¨æ–°åˆ†é é–‹å•Ÿï¼ˆ`target="_blank" rel="noopener noreferrer"`ï¼‰
3. Line é€£çµæ ¼å¼ï¼š`https://line.me/ti/p/{line_id}`
4. æœªå¡«å¯«çš„é€£çµä¸é¡¯ç¤º

**åœ–ç¤ºå¥—ä»¶é¸æ“‡**ï¼š
- Element Plus Iconsï¼ˆå…§å»ºï¼Œä½†å¯èƒ½ç¼ºå°‘ç¤¾ç¾¤åœ–ç¤ºï¼‰
- `@iconify/vue` + `@iconify-icons/fa` (Font Awesome Icons)
- `@vicons/fa` (Font Awesome for Vue 3)
- å»ºè­°ä½¿ç”¨ `@iconify/vue` ä»¥ç²å¾—æ›´å¤šç¤¾ç¾¤åœ–ç¤º

**å¾ŒçºŒ Story é—œè¯**ï¼š
- Story 2.1 å°‡å¯¦ä½œç·¨è¼¯åŸºæœ¬è³‡æ–™åŠŸèƒ½ï¼ˆå§“åã€Bioã€æ€§åˆ¥ã€å¹´é½¡ã€èˆˆè¶£ï¼‰
- Story 2.2 å·²å¯¦ä½œé ­åƒä¸Šå‚³åŠŸèƒ½
- Story 2.4 å°‡å¯¦ä½œå€‹äººå„€è¡¨æ¿ï¼ˆæ´»å‹•æ•¸ã€åª’åˆæ•¸ã€å¹³å‡è©•åƒ¹ï¼‰

## Testing

### Frontend Testing
```bash
# åŸ·è¡Œå–®å…ƒæ¸¬è©¦
npm run test:unit

# åŸ·è¡Œå¸¶è¦†è“‹ç‡çš„æ¸¬è©¦
npm run test:coverage

# UI æ¸¬è©¦æ¨¡å¼
npm run test:ui
```

### Backend Testing
```bash
# åŸ·è¡Œç”¨æˆ¶ç›¸é—œæ¸¬è©¦
pytest backend/tests/test_users.py -v

# å¸¶è¦†è“‹ç‡å ±å‘Š
pytest backend/tests/ --cov=backend/blueprints --cov-report=html
```

### Manual Testing Checklist

- [ ] è¨ªå•å€‹äººè³‡æ–™ç·¨è¼¯é é¢ï¼ˆéœ€ç™»å…¥ï¼‰
- [ ] é¡¯ç¤ºç¤¾ç¾¤é€£çµç·¨è¼¯å€å¡Š
- [ ] å¡«å¯« Instagram URL
- [ ] å¡«å¯« Facebook URL
- [ ] å¡«å¯« Line ID
- [ ] å¡«å¯« Twitter URL
- [ ] é©—è­‰ URL æ ¼å¼ï¼ˆæœ‰æ•ˆ/ç„¡æ•ˆï¼‰
- [ ] é¸æ“‡éš±ç§è¨­å®šï¼ˆå…¬é–‹/åƒ…å¥½å‹ï¼‰
- [ ] å„²å­˜ç¤¾ç¾¤é€£çµ
- [ ] é¡¯ç¤ºæˆåŠŸè¨Šæ¯
- [ ] æœ¬äººæŸ¥çœ‹å€‹äººè³‡æ–™é é¢é¡¯ç¤ºæ‰€æœ‰é€£çµ
- [ ] ç¤¾ç¾¤é€£çµé»æ“Šåœ¨æ–°åˆ†é é–‹å•Ÿ
- [ ] éå¥½å‹æŸ¥çœ‹ã€Œåƒ…å¥½å‹ã€è¨­å®šçš„å€‹äººè³‡æ–™é¡¯ç¤ºæç¤º
- [ ] å¥½å‹æŸ¥çœ‹ã€Œåƒ…å¥½å‹ã€è¨­å®šçš„å€‹äººè³‡æ–™é¡¯ç¤ºé€£çµ
- [ ] æ¸…é™¤æŒ‰éˆ•åŠŸèƒ½æ­£å¸¸
- [ ] éŸ¿æ‡‰å¼è¨­è¨ˆï¼ˆæ¡Œé¢/æ‰‹æ©Ÿæ¨¡å¼ï¼‰
- [ ] èªè­‰ä¿è­·ï¼ˆæœªç™»å…¥ç„¡æ³•æ›´æ–°ï¼‰
- [ ] API å›æ‡‰æ™‚é–“ < 2000ms

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-11-05 | 1.0 | Initial story creation | Bob (Scrum Master) |

## Dev Agent Record

*æ­¤å€å¡Šç”±é–‹ç™¼ä»£ç†åœ¨å¯¦ä½œæ™‚å¡«å¯«*

### Agent Model Used

(å¾…é–‹ç™¼ä»£ç†å¡«å¯«)

### Debug Log References

(å¾…é–‹ç™¼ä»£ç†å¡«å¯«)

### Completion Notes List

(å¾…é–‹ç™¼ä»£ç†å¡«å¯«)

### File List

(å¾…é–‹ç™¼ä»£ç†å¡«å¯«)

## QA Results

*æ­¤å€å¡Šç”± QA ä»£ç†å¯©æŸ¥å¾Œæ›´æ–°å¯©æŸ¥çµæœ*
