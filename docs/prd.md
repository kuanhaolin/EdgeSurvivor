# EdgeSurvivor 產品需求文件 (PRD)

## 1. 目標與背景脈絡

### 目標

* **用戶增長**：6 個月內達到 10,000 註冊用戶。
* **活動量**：每月新增 500+ 活動。
* **媒合成功率**：至少 60% 的活動成功媒合參與者。
* **用戶留存**：30 天留存率達 40%。
* **用戶滿意度**：活動評價平均 4.2 星以上。

### 背景脈絡

EdgeSurvivor 是一個專注於「旅伴與活動媒合」的社交平台，旨在解決獨自旅行者尋找志同道合旅伴的痛點。目前許多人想旅行卻找不到合適的同行者，導致計畫擱置。現有的解決方案（如 Facebook 社團）普遍缺乏結構化的媒合機制、行程協調工具、費用分攤功能以及足夠的安全隱私保護。

本 PRD 將詳細定義 MVP 階段所需的核心功能，這些功能均已在專案簡報中被標記為「已完成」。此文件旨在將這些已實現的功能轉化為正式的產品需求，以便進行後續的驗證、迭代以及未來 Phase 2 的規劃。

### 變更日誌

| 日期 | 版本 | 描述 | 作者 |
| --- | --- | --- | --- |
| 2025-11-03 | 1.0 | 初始 PRD 草稿，基於 v1.0 專案簡報創建 | John, PM |
| 2025-11-25 | 1.1 | 新增評分功能 (FR6.4-6.5)、取消參與 (FR4.4)、刪除活動 (FR3.5) | John, PM |

---

## 2. 需求

### 功能性需求 (Functional)

(基於專案簡報中「MVP Scope」>「Core Features」)

* **FR1: 使用者認證系統**
    * FR1.1: 系統應提供 Email/密碼註冊、登入、登出功能。
    * FR1.2: 系統應支援 JWT Token 驗證機制。
    * FR1.3: 系統應提供 Email 驗證機制。
    * FR1.4: 系統應支援 Google OAuth2 第三方登入。
    * FR1.5: 系統應提供忘記密碼（Email 重設）功能。
    * FR1.6: 系統應允許使用者變更密碼及刪除帳號。
* **FR2: 個人資料管理**
    * FR2.1: 使用者應能夠編輯基本資料（姓名、Bio、興趣等）。
    * FR2.2: 使用者應能夠上傳個人頭像。
    * FR2.3: 使用者應能夠設定社群帳號連結及其隱私（公開/不公開）。
    * FR2.4: 使用者應能查看個人統計儀表板（活動數、媒合數、評價數）。
* **FR3: 活動管理**
    * FR3.1: 使用者應能建立活動（包含標題、日期、地點、描述、類別、人數上限、費用、封面圖）。
    * FR3.2: 使用者應能瀏覽、搜尋及篩選（依地點、日期、類型等）活動列表。
    * FR3.3: 系統應提供活動詳細頁面，顯示所有活動資訊。
    * FR3.4: 活動創建者應能管理活動狀態（開放/進行中/已完成/已取消）。
    * FR3.5: 活動創建者應能刪除自己創建的活動。
* **FR4: 參與者管理**
    * FR4.1: 使用者應能申請加入活動並附帶訊息。
    * FR4.2: 活動創建者應能審核申請（批准/拒絕）。
    * FR4.3: 活動參與者應能查看參與者列表。
    * FR4.4: 已批准的參與者應能取消參與活動（離開活動）。
* **FR5: 互動與媒合**
    * FR5.1: 活動參與者應能在活動頁面的即時討論串中交流。
    * FR5.2: 使用者應能建立媒合申請，並管理媒合狀態。
    * FR5.3: 媒合成功的雙方應能開啟私人即時聊天室 (Socket.IO)。
* **FR6: 活動後續功能**
    * FR6.1: 活動參與者應能新增費用記錄（類別、金額、付款者）。
    * FR6.2: 系統應能自動計算並顯示最佳費用分攤結算報告。
    * FR6.3: 活動完成後，參與者應能互相留下評價與評語。
    * FR6.4: 評價系統應包含必填的數字評分（1-5 星）及文字評語。
    * FR6.5: 使用者應能查看其他使用者的平均評分及評價統計。

### 非功能性需求 (Non-Functional)

* **NFR1: 效能**
    * NFR1.1: 所有 API 回應時間應低於 500ms。
    * NFR1.2: 系統應能支援至少 1,000 名使用者同時在線。
* **NFR2: 安全性**
    * NFR2.1: 密碼必須使用 scrypt 進行加密儲存。
    * NFR2.2: 必須使用 JWT 進行 API 驗證，並包含 Access/Refresh Token 機制。
    * NFR2.3: 必須實施 CORS 政策，限制允許的來源。
    * NFR2.4: 所有資料庫查詢必須使用 ORM 參數化查詢，以防止 SQL 注入。
    * NFR2.5: 檔案上傳必須驗證檔案類型與大小（< 16MB）。
* **NFR3: 瀏覽器支援**
    * NFR3.1: 系統應支援 Chrome 90+、Firefox 88+、Safari 14+ 及 Edge 90+。
* **NFR4: 可用性**
    * NFR4.1: 系統可用性應達到 99% (MVP 階段)。
* **NFR5: 資料庫**
    * NFR5.1: 系統應使用 MariaDB 10.11 或 MySQL 8.x 作為主資料庫。

---

## 3. 使用者介面設計目標

(此部分為高階產品願景，用以指導 UX 專家)

### 整體 UX 願景
成為台灣最受信賴的旅伴媒合平台，提供安全、便捷、透明的體驗，讓每個想旅行的人都能找到最適合的同行者。

### 關鍵互動範式
* **活動建立**：透過清晰的表單引導使用者發布結構化活動。
* **申請與審核**：提供明確的按鈕與狀態列表來管理參與者。
* **即時通訊**：在活動討論串與私人聊天室中提供即時訊息體驗。
* **費用管理**：透過簡易表單記錄開銷，並自動化呈現結算報告。
* **評價系統**：使用星級與評語進行雙向回饋。

### 核心畫面與視圖
* 註冊 / 登入頁面
* 個人儀表板 (Dashboard)
* 活動列表 (瀏覽 / 搜尋 / 篩選)
* 活動詳細頁面 (包含資訊、參與者、討論串、費用、相簿)
* 建立 / 編輯活動頁面
* 私人聊天室
* 費用分攤頁面
* 個人資料編輯頁面

### 無障礙訪問性 (Accessibility)
* MVP 階段：TBD (待 Phase 2 規劃)

### 品牌
* MVP 階段：TBD (待 Phase 2 規劃)

### 目標裝置與平台
* Web Responsive (響應式網頁，支援桌面與行動瀏覽器)

---

## 4. 技術假設

### 儲存庫結構
* Monorepo (基於專案簡報 `EdgeSurvivor/ backend/ frontend/ db/` 結構)

### 服務架構
* Monolith (Flask 後端) + SPA (Vue 3 前端)
* 後端採用 Flask Blueprint 進行模組化設計
* 採用 RESTful API 架構

### 測試需求
* MVP 階段已完成基本的核心功能測試。
* Phase 2 應導入更嚴謹的單元測試 (Unit Testing) 與整合測試 (Integration Testing)。

### 額外的技術假設和請求
* **即時通訊**: 必須使用 Socket.IO (Flask-SocketIO 與 Socket.IO Client) 實現。
* **資料庫**: 必須使用 SQLAlchemy 2.x 作為 ORM。
* **認證**: 必須使用 Flask-JWT-Extended 進行 JWT 管理。
* **部署**: 必須支援 Docker + Docker Compose 容器化部署。

---

## 5. 史詩列表 (Epic List)

(基於已完成的 MVP 功能進行邏輯分組)

* **Epic 0: 專案基礎設施與環境設定**：建立完整的開發環境、測試基礎設施和部署管道，為所有後續功能開發提供穩固的技術基礎。（**優先級 P0 - 必須最先完成**）
* **Epic 1: 使用者核心與認證**：建立核心使用者系統，包含安全的註冊、登入、認證機制以及個人資料管理。
* **Epic 2: 活動探索與管理**：讓使用者能發布、探索、篩選及管理旅行活動，建立平台的核心內容。
* **Epic 3: 媒合與社交**：提供使用者間一對一的媒合機制，並在媒合成功後提供安全的私人通訊管道。
* **Epic 4: 活動工具**：提供活動執行中及完成後所需的工具，包含費用分攤與互相評價，完成端到端的活動體驗。

---

## 6. 史詩詳情

### Epic 0: 專案基礎設施與環境設定
**Epic 目標**: 建立完整的開發環境、測試基礎設施和部署管道，為所有後續功能開發提供穩固的技術基礎。

**優先級**: P0（最高優先級 - 所有功能開發的前置條件）

**Epic 價值**:
* 確保開發團隊能快速搭建一致的開發環境
* 建立自動化測試能力，保證程式碼品質
* 設定 CI/CD 管道，實現快速且可靠的部署
* 為 Brownfield 專案提供現有系統的完整分析文件

**Story 0.1: 本地開發環境設定與驗證**
* **As a** 新加入的開發者,
* **I want** 按照明確的步驟快速設定本地開發環境,
* **so that** 我能在 30 分鐘內開始進行開發工作。
* *(涵蓋工具安裝、環境變數配置、資料庫連線驗證)*

**Story 0.2: 後端依賴安裝與資料庫初始化**
* **As a** 開發者,
* **I want** 一鍵安裝所有後端依賴並初始化資料庫結構,
* **so that** 我能快速開始後端開發。
* *(涵蓋 requirements.txt、資料庫遷移、測試資料)*

**Story 0.3: 前端專案初始化與建置配置**
* **As a** 前端開發者,
* **I want** 快速安裝前端依賴並啟動開發伺服器,
* **so that** 我能開始前端開發並享受熱重載功能。
* *(涵蓋 npm install、Vite 配置、API 代理)*

**Story 0.4: 測試框架設定與範例測試**
* **As a** 開發者,
* **I want** 專案有完整的測試框架和範例測試,
* **so that** 我能為新功能編寫測試並確保程式碼品質。
* *(涵蓋 pytest、vitest、測試目錄結構、覆蓋率報告)*

**Story 0.5: CI/CD 管道與部署配置**
* **As a** 開發團隊,
* **I want** 自動化的 CI/CD 管道,
* **so that** 每次程式碼提交都能自動測試和部署。
* *(涵蓋 GitHub Actions、Docker 配置、自動化部署)*

**Story 0.6: 現有系統分析與整合點識別**
* **As a** 新加入的開發者,
* **I want** 完整的現有系統分析文件,
* **so that** 我能快速了解系統架構和整合點。
* *(涵蓋架構圖、API 端點列表、資料庫 Schema、整合點識別)*

**Epic 依賴關係**: 無前置依賴，是所有其他 Epic (Epic 1-4) 的前置條件。

**詳細規格**: 參見 `docs/epic/epic-0-專案基礎設施與環境設定.md`

### Epic 1: 使用者核心與認證
**Epic 目標**: 建立核心使用者系統，包含安全的註冊、登入、認證機制以及個人資料管理，為所有後續功能提供基礎。

**前置條件**: Epic 0 必須完成

**Story 1.1: 使用者註冊與 Email 驗證**
* **As a** 新訪客,
* **I want** 透過 Email 和密碼註冊帳號，並完成 Email 驗證,
* **so that** 我可以成為平台會員並確保帳號安全。
* *(涵蓋 FR1.1, FR1.3, NFR2.1)*

**Story 1.2: 使用者登入與 JWT 驗證**
* **As a** 已註冊使用者,
* **I want** 使用 Email 和密碼登入，並取得 JWT (Access/Refresh Tokens),
* **so that** 我可以存取需要認證的平台功能。
* *(涵蓋 FR1.1, FR1.2, NFR2.2)*

**Story 1.3: Google OAuth2 第三方登入**
* **As a** 新訪客或使用者,
* **I want** 透過我的 Google 帳號快速登入或註冊,
* **so that** 我可以節省填寫資料的時間。
* *(涵蓋 FR1.4)*

**Story 1.4: 密碼管理與帳號刪除**
* **As a** 使用者,
* **I want** 能夠在忘記密碼時透過 Email 重設，並能隨時變更密碼或刪除我的帳號,
* **so that** 我對我的帳號有完全的控制權。
* *(涵蓋 FR1.5, FR1.6)*

**Story 1.5: 個人資料與頭像編輯**
* **As a** 使用者,
* **I want** 編輯我的基本資料、興趣、社群連結，並上傳個人頭像,
* **so that** 其他使用者能更了解我。
* *(涵蓋 FR2.1, FR2.2, FR2.3, NFR2.5)*

**Story 1.6: 個人統計儀表板**
* **As a** 使用者,
* **I want** 查看我的個人儀表板，包含我發起/參與的活動數、媒合數及平均評價,
* **so that** 我可以快速了解我的平台活動概況。
* *(涵蓋 FR2.4)*

### Epic 2: 活動探索與管理
**Epic 目標**: 讓使用者能發布、探索、篩選及管理旅行活動，建立平台的核心內容。

**前置條件**: Epic 0 (基礎設施) 和 Epic 1 (使用者認證) 必須完成

**Story 2.1: 建立新活動**
* **As a** 使用者,
* **I want** 填寫一個包含所有必要資訊（標題、日期、地點、描述、類型、人數、費用、封面圖）的表單來建立新活動,
* **so that** 我可以開始招募旅伴。
* *(涵蓋 FR3.1)*

**Story 2.2: 瀏覽、搜尋與篩選活動**
* **As a** 使用者,
* **I want** 在活動列表頁面瀏覽所有活動，並能透過關鍵字搜尋或依地點、日期、類型等條件篩選,
* **so that** 我能快速找到感興趣的活動。
* *(涵蓋 FR3.2, NFR1.1)*

**Story 2.3: 查看活動詳細資料**
* **As a** 使用者,
* **I want** 點擊任一活動以查看其詳細資訊，包含描述、參與者列表、討論串、費用和相簿,
* **so that** 我能決定是否要申請加入。
* *(涵蓋 FR3.3)*

**Story 2.4: 管理活動狀態**
* **As a** 活動創建者,
* **I want** 能夠將我的活動狀態設定為「進行中」、「已完成」或「已取消」,
* **so that** 參與者和其他使用者能了解活動的最新進度。
* *(涵蓋 FR3.4)*

**Story 2.5: 活動參與申請與審核**
* **As a** 使用者,
* **I want** 申請加入我感興趣的活動，並附帶一段訊息給創建者,
* **so that** 我有機會成為活動的一員。
* *(涵蓋 FR4.1)*

* **As a** 活動創建者,
* **I want** 審核（批准或拒絕）其他使用者的加入申請，並查看所有參與者列表,
* **so that** 我可以篩選出最適合的旅伴。
* *(涵蓋 FR4.2, FR4.3)*

### Epic 3: 媒合與社交
**Epic 目標**: 提供使用者間一對一的媒合機制，並在媒合成功後提供安全的私人通訊管道。

**前置條件**: Epic 0, Epic 1, Epic 2 必須完成

**Story 3.1: 建立與管理媒合申請**
* **As a** 使用者,
* **I want** 對特定使用者發出媒合申請，並能管理我發出和收到的申請狀態（待確認/已接受/已拒絕等）,
* **so that** 我可以主動尋找潛在的旅伴。
* *(涵蓋 FR5.2)*

**Story 3.2: 啟用私人聊天室**
* **As a** 使用者,
* **I want** 在媒合申請被雙方確認後，自動開啟一個私人聊天室,
* **so that** 我可以安全地與對方討論行程細節。
* *(涵蓋 FR5.3)*

**Story 3.3: 活動公開討論串**
* **As a** 活動參與者,
* **I want** 在活動詳細頁面的討論串中發送和查看訊息,
* **so that** 我可以與所有參與者公開討論行程。
* *(涵蓋 FR5.1)*

### Epic 4: 活動工具
**Epic 目標**: 提供活動執行中及完成後所需的工具，包含費用分攤與互相評價，完成端到端的活動體驗。

**前置條件**: Epic 0, Epic 1, Epic 2, Epic 3 必須完成

**Story 4.1: 費用記錄與自動分攤**
* **As a** 活動參與者,
* **I want** 在活動中新增每筆開銷（類別、金額、付款者），並在活動結束後查看系統自動計算的最佳分攤結算報告,
* **so that** 我們可以公平且方便地結清費用。
* *(涵蓋 FR6.1, FR6.2)*

**Story 4.2: 活動後互相評價**
* **As a** 活動參與者,
* **I want** 在活動狀態變為「已完成」後，對其他參與者留下星級評價和評語,
* **so that** 建立平台上的信任機制。
* *(涵蓋 FR6.3)*

---

## 7. 檢查清單結果報告

(此部分將在 `*execute-checklist pm-checklist` 命令執行後填入)

* [PM 檢查清單的驗證結果摘要將顯示於此處]

---

## 8. 後續步驟

### UX 專家提示
請 UX 專家檢閱此 PRD，並根據「使用者介面設計目標」部分，開始構思詳細的 UI/UX 規格 (front-end-spec.md)。

### 架構師提示
請架構師檢閱此 PRD，特別是「需求」和「技術假設」部分，以開始設計詳細的系統架構 (architecture.md)。