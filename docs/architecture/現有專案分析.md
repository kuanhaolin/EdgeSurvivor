# 現有專案分析

## 當前專案狀態

**主要目的：** 旅伴媒合與活動管理平台，專為獨自旅行者提供尋找志同道合旅伴、管理群組活動的完整解決方案，整合即時聊天、費用分攤和評價系統。

**當前技術堆疊：**
- **前端：** Vue 3.3.8 (Composition API)、Element Plus 2.4.2、Pinia 2.1.7、Socket.IO Client 4.7.4
- **後端：** Flask 2.3.3、Flask-SocketIO 5.3.6、SQLAlchemy 2.0.23 (ORM 2.x 語法)、Flask-JWT-Extended 4.5.3
- **資料庫：** MariaDB 10.11，配置連線池（pool_size=20, max_overflow=40）
- **部署：** Docker Compose，前端/後端/資料庫分離容器

**架構風格：**
- 三層式 Web 應用程式，關注點清晰分離
- Flask Blueprint 模組化架構（9 個 Blueprint：auth、users、activities、matches、chat、discussions、expenses、reviews、upload）
- Vue 3 Composition API，使用 `<script setup>` 語法
- RESTful API + WebSocket 雙通道通訊模式

**部署方法：**
- Docker 化容器部署，透過 Docker Compose
- 生產環境使用 Gunicorn + Gevent WSGI 伺服器
- 生產整合使用 Nginx 反向代理
- 支援開發（直接 CORS）和生產（代理）模式

## 可用文檔

- **完整 PRD**（docs/prd.md）- 694 行，涵蓋所有 7 個 epic 故事、功能/非功能需求
- **詳細技術文檔**（docs/brownfield-architecture.md）- 1131 行，包含完整技術堆疊、資料模型、API 規格
- **部署指南**（DEPLOYMENT_GUIDE.md）- 457 行，包含 Docker 設定和生產部署
- **專案簡介**（docs/project-brief.md）- 853 行，包含需求和規格
- **170+ 測試案例**（backend/test/）- 完整 pytest 測試套件，涵蓋核心功能
- **資料庫架構**（db/init-complete.sql）- 所有表格的完整 DDL

## 識別的約束條件

- **WebSocket 可擴展性**：線上用戶列表使用記憶體內字典（`online_users`），不適合水平擴展（已記錄的技術債務）
- **檔案儲存**：本地檔案系統儲存在 `backend/uploads/` - 不適合分散式系統
- **資料庫架構相容性**：必須維護 `Activity.date` 欄位與新的 `start_date/end_date` 以實現向後相容
- **SQLAlchemy 版本**：承諾使用 2.x 語法模式（不使用舊版 1.x 查詢模式）
- **CORS 配置**：限制為特定來源（localhost:3000、localhost:8080、生產網域）
- **JWT Token 流程**：access + refresh token 模式必須保持不變以支援現有前端
- **Socket.IO 協定**：事件名稱和資料格式不能變更，否則會破壞現有客戶端
- **Python 版本**：需要 Python 3.9+（gevent/gunicorn 相容性）
- **測試隔離**：測試使用 SQLite 記憶體內資料庫，而非 MariaDB（可能有行為差異）

---
