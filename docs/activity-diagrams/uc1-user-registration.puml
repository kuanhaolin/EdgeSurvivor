@startuml UC1: 使用者註冊活動圖
!theme plain

skinparam activity {
    FontSize 12
}

skinparam swimlane {
    TitleFontSize 14
    TitleFontStyle bold
}

title UC1: 使用者註冊流程活動圖

|使用者|
start

:點擊「註冊」按鈕;

|前端 SPA\nviews/Register.vue\napi/auth.js|
:顯示註冊表單;

|使用者|
:輸入 Email、密碼、姓名;

:點擊「送出」;

|前端 SPA\nviews/Register.vue\napi/auth.js|
:驗證表單格式\n(前端驗證);

:發送 POST /api/auth/register;

|後端 API\nblueprints/auth.py|
:接收註冊請求;

if (Email 格式正確?) then (是)
    :驗證 Email 唯一性;
    
    if (Email 已被註冊?) then (否)
        if (密碼長度 >= 6?) then (是)
            :使用 scrypt 加密密碼\n(models/user.py);
            
            |資料庫\nMariaDB|
            :建立使用者記錄\n(INSERT INTO users);
            
            |後端 API\nblueprints/auth.py|
            :建立 JWT Token\n(access_token, refresh_token);
            
            :返回 HTTP 201\n使用者資料與 Token;
            
            |前端 SPA\nviews/Register.vue\napi/auth.js|
            :儲存 Token 至 localStorage;
            
            :導向主控台頁面;
            stop
        else (否)
            |後端 API\nblueprints/auth.py|
            :返回 HTTP 400\n錯誤：密碼至少需要 6 個字元;
            
            |前端 SPA\nviews/Register.vue\napi/auth.js|
            :顯示錯誤訊息;
            stop
        endif
    else (是)
        |後端 API\nblueprints/auth.py|
        :返回 HTTP 400\n錯誤：Email 已被註冊;
        
        |前端 SPA\nviews/Register.vue\napi/auth.js|
        :顯示錯誤訊息;
        stop
    endif
else (否)
    |前端 SPA\nviews/Register.vue\napi/auth.js|
    :顯示錯誤：Email 格式不正確;
    stop
endif

@enduml
